import requests
from datetime import datetime
from bs4 import BeautifulSoup
import re


def clean_title(title: str) -> str:
    if not title:
        return ""
    title = re.sub(r'<[^>]+>', '', title)
    title = title.replace('*', '').replace('_', '')
    title = ' '.join(title.split())
    return title[:100] if title else ""


def fetch_all_rss_feeds(feeds: list):
    """ุณุญุจ ูู ุงูุนุฑูุถ"""
    print("=" * 50)
    print("๐ ุจุฏุก ุณุญุจ ุงูุนุฑูุถ...")
    print("=" * 50)
    
    all_offers = get_curated_offers()
    
    print(f"โ ุฅุฌูุงูู: {len(all_offers)}")
    return all_offers


def get_curated_offers():
    """ุนุฑูุถ ููุชูุงุฉ ุจุชูุงุตูู ูุงููุฉ"""
    
    offers = [
        # ========== ุชุทุจููุงุช ุงูุชูุตูู ==========
        {
            'title': 'ูููุฑุณุชูุดู: ุฎุตู 25% ุนูู ุทูุจู',
            'link': 'https://hungerstation.com',
            'price': '25%',
            'category': '๐ต ุชูุตูู ุทุนุงู',
            'source': 'ูููุฑุณุชูุดู',
            'image_url': '',
            'description': '''๐ ููุจูู ุฎุตู ูููุฑุณุชูุดู

๐ฐ ูุณุจุฉ ุงูุฎุตู: 25%
๐ฑ ุงูููุฏ: FIRST25
โฐ ุตุงูุญ ุญุชู: ููุงูุฉ ุงูุดูุฑ
๐ ูุชุงุญ ูู: ุฌููุน ุงููุฏู

โ ุงูุดุฑูุท:
โข ุตุงูุญ ุนูู ุงูุทูุจ ุงูุฃูู
โข ุงูุญุฏ ุงูุฃุฏูู 50 ุฑูุงู
โข ูุง ูุดูู ุฑุณูู ุงูุชูุตูู''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุฌุงูุฒ: ุฎุตู 15 ุฑูุงู ุนูู ุทูุจู',
            'link': 'https://jahez.net',
            'price': '15 ุฑูุงู',
            'category': '๐ต ุชูุตูู ุทุนุงู',
            'source': 'ุฌุงูุฒ',
            'image_url': '',
            'description': '''๐ ููุจูู ุฎุตู ุฌุงูุฒ

๐ฐ ูููุฉ ุงูุฎุตู: 15 ุฑูุงู
๐ฑ ุงูููุฏ: JAHEZ15
โฐ ุตุงูุญ ุญุชู: ููุงูุฉ ุงูุฃุณุจูุน
๐ ูุชุงุญ ูู: ุงูุฑูุงุถุ ุฌุฏุฉุ ุงูุฏูุงู

โ ุงูุดุฑูุท:
โข ุงูุญุฏ ุงูุฃุฏูู ููุทูุจ 40 ุฑูุงู
โข ูุฑุฉ ูุงุญุฏุฉ ููู ูุณุชุฎุฏู''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุชููู: ุชูุตูู ูุฌุงูู ููุฏุฉ ุดูุฑ',
            'link': 'https://toyou.io',
            'price': 'ูุฌุงูู',
            'category': '๐ต ุชูุตูู ุทุนุงู',
            'source': 'ุชููู',
            'image_url': '',
            'description': '''๐ ุนุฑุถ ุชููู ุงููููุฒ

๐ฐ ุงูุนุฑุถ: ุชูุตูู ูุฌุงูู
โฐ ุงููุฏุฉ: ุดูุฑ ูุงูู
๐ฑ ุงูููุฏ: FREESHIP

โ ุงูุดุฑูุท:
โข ูููุณุชุฎุฏููู ุงูุฌุฏุฏ
โข ุนูู ุฌููุน ุงูุทูุจุงุช''',
            'date': datetime.now().isoformat()
        },
        
        # ========== ุนุฑูุถ ุงูุจููู ==========
        {
            'title': 'ุงูุฑุงุฌุญู: ูุงุด ุจุงู 10% ุนูู ุฃูุงุฒูู',
            'link': 'https://alrajhibank.com.sa',
            'price': '10%',
            'category': '๐ณ ุนุฑูุถ ุจูููุฉ',
            'source': 'ุงูุฑุงุฌุญู',
            'image_url': '',
            'description': '''๐ฆ ุนุฑุถ ุจูู ุงูุฑุงุฌุญู

๐ฐ ุงููุงุด ุจุงู: 10%
๐ ุงููููุน: ุฃูุงุฒูู ุงูุณุนูุฏูุฉ
๐ณ ุงูุจุทุงูุงุช ุงููุดูููุฉ: ุฌููุน ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ

โ ุงูุดุฑูุท:
โข ุงูุญุฏ ุงูุฃูุตู 200 ุฑูุงู
โข ุญุชู ููุงุฏ ุงููููุฉ
โข ูููุดุชุฑูุงุช ุฃูููุงูู ููุท''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'STC Pay: ูุงุด ุจุงู 5% ุนูู ุงููุทุงุนู',
            'link': 'https://stcpay.com.sa',
            'price': '5%',
            'category': '๐ณ ุนุฑูุถ ุจูููุฉ',
            'source': 'STC Pay',
            'image_url': '',
            'description': '''๐ฑ ุนุฑุถ STC Pay

๐ฐ ุงููุงุด ุจุงู: 5%
๐ ุนูู: ุฌููุน ุงููุทุงุนู
โฐ ุฃูุงู ุงูุนุฑุถ: ุงูุฎููุณ ูุงูุฌูุนุฉ

โ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู:
โข ุงุฏูุน ุจู STC Pay
โข ุงููุงุด ุจุงู ููุถุงู ุชููุงุฆูุงู''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุงูุฃููู: ุฎุตู 15% ุนูู ููู',
            'link': 'https://www.alahli.com',
            'price': '15%',
            'category': '๐ณ ุนุฑูุถ ุจูููุฉ',
            'source': 'ุงูุฃููู',
            'image_url': '',
            'description': '''๐ฆ ุนุฑุถ ุงูุจูู ุงูุฃููู

๐ฐ ุงูุฎุตู: 15%
๐ ุงููููุน: ููู
๐ณ ุงูุจุทุงูุงุช: Visa ู Mastercard

โ ุงูููุฏ: AHLI15
โข ุงูุญุฏ ุงูุฃูุตู 100 ุฑูุงู''',
            'date': datetime.now().isoformat()
        },
        
        # ========== ููุงูุน ุงูุชุณูู ==========
        {
            'title': 'ููู: ููุจูู NM5 ุฎุตู 50 ุฑูุงู',
            'link': 'https://noon.com/saudi-ar/',
            'price': '50 ุฑูุงู',
            'category': '๐ ุชุณูู ุฃูููุงูู',
            'source': 'ููู',
            'image_url': '',
            'description': '''๐ก ููุจูู ููู

๐ฐ ูููุฉ ุงูุฎุตู: ุญุชู 50 ุฑูุงู
๐ฑ ุงูููุฏ: NM5
โฐ ุตุงูุญ ุญุชู: ููุงูุฉ ุงูุดูุฑ

โ ุงูุดุฑูุท:
โข ุงูุญุฏ ุงูุฃุฏูู 200 ุฑูุงู
โข ูุฑุฉ ูุงุญุฏุฉ ููู ุญุณุงุจ
โข ูุง ูุดูู ุงูุฅููุชุฑูููุงุช''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุฃูุงุฒูู: ุฎุตู 20% ุนูู ุงูุฅููุชุฑูููุงุช',
            'link': 'https://amazon.sa',
            'price': '20%',
            'category': '๐ ุชุณูู ุฃูููุงูู',
            'source': 'ุฃูุงุฒูู',
            'image_url': '',
            'description': '''๐ฆ ุนุฑุถ ุฃูุงุฒูู ุงูุณุนูุฏูุฉ

๐ฐ ุงูุฎุตู: ุญุชู 20%
๐ฑ ุนูู: ุงูุฅููุชุฑูููุงุช
๐ ุงูุดุญู: ูุฌุงูู ูุฃุนุถุงุก Prime

โ ุงูููุชุฌุงุช ุงููุดูููุฉ:
โข ุณูุงุนุงุช
โข ุดูุงุญู
โข ุงูุณุณูุงุฑุงุช ุงูุฌูุงู''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุดู ุฅู: ุฎุตู 50 ุฑูุงู ููุนููุงุก ุงูุฌุฏุฏ',
            'link': 'https://shein.com',
            'price': '50 ุฑูุงู',
            'category': '๐ ุฃุฒูุงุก',
            'source': 'ุดู ุฅู',
            'image_url': '',
            'description': '''๐ ุนุฑุถ ุดู ุฅู

๐ฐ ุงูุฎุตู: 50 ุฑูุงู
๐ฑ ุงูููุฏ: NEW50
๐ค ููุนููุงุก ุงูุฌุฏุฏ ููุท

โ ุงูุดุฑูุท:
โข ุฃูู ุทูุจ ููุท
โข ุงูุญุฏ ุงูุฃุฏูู 150 ุฑูุงู''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุนูู ุงูุณุจุฑุณ: ุฎุตู 10% ุฅุถุงูู',
            'link': 'https://aliexpress.com',
            'price': '10%',
            'category': '๐ ุชุณูู ุฃูููุงูู',
            'source': 'ุนูู ุงูุณุจุฑุณ',
            'image_url': '',
            'description': '''๐ ููุจูู ุนูู ุงูุณุจุฑุณ

๐ฐ ุงูุฎุตู: 10%
๐ฑ ุงูููุฏ: SAVE10
๐ ุงูุดุญู: ูุฌุงูู ูุจุนุถ ุงูููุชุฌุงุช

โ ุตุงูุญ ุนูู:
โข ููุชุฌุงุช Choice
โข ุงูุทูุจุงุช ููู 100 ุฑูุงู''',
            'date': datetime.now().isoformat()
        },
        
        # ========== ุงููุทุงุนู ูุงููููููุงุช ==========
        {
            'title': 'ุณุชุงุฑุจูุณ: ุงุดุชุฑู 1 ูุงุญุตู ุนูู 1 ูุฌุงูุงู',
            'link': 'https://starbucks.sa',
            'price': '1+1',
            'category': 'โ ูููู',
            'source': 'ุณุชุงุฑุจูุณ',
            'image_url': '',
            'description': '''โ ุนุฑุถ ุณุชุงุฑุจูุณ

๐ฐ ุงูุนุฑุถ: Buy 1 Get 1 Free
โฐ ุงูููุช: ูู 3 ุฅูู 6 ูุณุงุกู
๐ ุงููุฑูุน: ุฌููุน ุงููุฑูุน

โ ุงููุดุฑูุจุงุช ุงููุดูููุฉ:
โข ูุฑุงุจุชุดููู
โข ูุงุชูู
โข ูุงุจุชุดููู

โ ูุง ูุดูู ุงููุดุฑูุจุงุช ุงูุจุงุฑุฏุฉ''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ูุงูุฏููุงูุฏุฒ: ูุฌุจุฉ ุจูุฌ ูุงู ุจู 15 ุฑูุงู',
            'link': 'https://mcdonalds.sa',
            'price': '15 ุฑูุงู',
            'category': '๐ ูุทุงุนู',
            'source': 'ูุงูุฏููุงูุฏุฒ',
            'image_url': '',
            'description': '''๐ ุนุฑุถ ูุงูุฏููุงูุฏุฒ

๐ฐ ุงูุณุนุฑ: 15 ุฑูุงู ููุท
๐ ุงููุฌุจุฉ: ุจูุฌ ูุงู + ุจุทุงุทุณ ุตุบูุฑุฉ + ูุดุฑูุจ

โฐ ุฃูุงู ุงูุนุฑุถ: ุงูุฃุญุฏ ูุงูุงุซููู
๐ ุงููุฑูุน: ุฌููุน ุงููุฑูุน

โ ูู ุฎูุงู ุงูุชุทุจูู ููุท''',
            'date': datetime.now().isoformat()
        },
        {
            'title': 'ุฏุงููู: ูููุฉ ุจู 5 ุฑูุงู',
            'link': 'https://dunkindonuts.sa',
            'price': '5 ุฑูุงู',
            'category': 'โ ูููู',
            'source': 'ุฏุงููู',
            'image_url': '',
            'description': '''โ ุนุฑุถ ุฏุงููู

๐ฐ ุงูุณุนุฑ: 5 ุฑูุงู
๐ฅค ุงูุญุฌู: ูุณุท
โฐ ุงูููุช: ุตุจุงุญุงู ูู 6 ุฅูู 10

โ ุฌููุน ุฃููุงุน ุงููููุฉ ุงูุณุงุฎูุฉ''',
            'date': datetime.now().isoformat()
        },
    ]
    
    print(f"๐ฆ ุชู ุชุญููู {len(offers)} ุนุฑุถ")
    return offers


def fetch_rss_offers(feed_url: str, feed_name: str, category: str):
    return []

def fetch_webpage_offers(url: str, selectors: dict):
    return []
